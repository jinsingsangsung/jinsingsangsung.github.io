---
import { getMenu, getCollections } from "@/utils";
import { getAllPages, getDatabase } from "@/lib/notion/client";
import { MENU_PAGES_COLLECTION, HOME_PAGE_SLUG } from "@/constants";
import { slugify } from "@/utils/slugify";
import { getNavLink } from "@/lib/blog-helpers";

const pages = await getAllPages();
const collections = await getCollections();
const database = await getDatabase();
const menuLinks = await getMenu();

// Filter pages that might be Gallery-related
const galleryPages = pages.filter(page => 
  page.Title.toLowerCase().includes('gallery') || 
  page.Slug.toLowerCase().includes('gallery') ||
  page.Collection?.toLowerCase().includes('gallery')
);
---

<html>
<head>
    <title>Gallery Debug Info</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
        .highlight { background: yellow; }
    </style>
</head>
<body>
    <h1>Gallery Debug Information</h1>
    
    <div class="section">
        <h2>Configuration</h2>
        <pre>MENU_PAGES_COLLECTION: {MENU_PAGES_COLLECTION}
HOME_PAGE_SLUG: {HOME_PAGE_SLUG}</pre>
    </div>

    <div class="section">
        <h2>Database Info</h2>
        <pre>Database Title: {database.Title}
Database Description: {database.Description}</pre>
    </div>

    <div class="section">
        <h2>All Collections</h2>
        <pre>{JSON.stringify(collections, null, 2)}</pre>
    </div>

    <div class="section">
        <h2>Gallery-Related Pages</h2>
        <pre>{JSON.stringify(galleryPages.map(p => ({
            Title: p.Title,
            Slug: p.Slug,
            Collection: p.Collection,
            Rank: p.Rank,
            Published: p.Published
        })), null, 2)}</pre>
    </div>

    <div class="section">
        <h2>All Pages Summary</h2>
        <pre>{JSON.stringify(pages.map(p => ({
            Title: p.Title,
            Slug: p.Slug,
            Collection: p.Collection,
            Rank: p.Rank
        })), null, 2)}</pre>
    </div>

    <div class="section">
        <h2>Generated Menu Links</h2>
        <pre>{JSON.stringify(menuLinks, null, 2)}</pre>
    </div>

    <div class="section">
        <h2>Expected Gallery URLs</h2>
        <p>If there's a Gallery collection, it should be accessible at:</p>
        <pre>/collections/{slugify('Gallery')} = /collections/{slugify('Gallery')}</pre>
        
        <p>If there's a Gallery page, it should be accessible at:</p>
        <pre>/{galleryPages.length > 0 ? galleryPages[0].Slug : 'NO_GALLERY_PAGE_FOUND'}</pre>
    </div>
</body>
</html>